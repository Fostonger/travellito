<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timezone Detection Test</title>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.3/build/global/luxon.min.js"></script>
    <style>
        body { font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        section { margin-bottom: 30px; border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
        h1 { color: #0078d7; }
        h2 { color: #0078d7; margin-top: 0; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 5px; overflow-x: auto; }
        .info { margin-bottom: 10px; }
        button { background: #0078d7; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0063b1; }
    </style>
</head>
<body>
    <h1>Timezone Detection Test</h1>

    <section>
        <h2>Browser Timezone Detection</h2>
        <div class="info">Intl.DateTimeFormat().resolvedOptions().timezone: <strong id="browser-timezone"></strong></div>
        <div class="info">Date.getTimezoneOffset(): <strong id="timezone-offset"></strong></div>
        <div class="info">Current Local Time: <strong id="local-time"></strong></div>
    </section>

    <section>
        <h2>Luxon Timezone Detection</h2>
        <div class="info">luxon.DateTime.local().zoneName: <strong id="luxon-timezone"></strong></div>
        <div class="info">luxon.DateTime.local().toString(): <strong id="luxon-datetime"></strong></div>
        <div class="info">Offset (ZZ): <strong id="luxon-offset"></strong></div>
        <div class="info">Formatted with Timezone: <strong id="luxon-formatted"></strong></div>
    </section>

    <section>
        <h2>Timezone Test</h2>
        <div>
            <label for="test-time">Test Time (HH:MM):</label>
            <input type="time" id="test-time" value="14:30">
            <button id="convert-btn">Convert to UTC</button>
        </div>
        <div class="info" style="margin-top:10px">
            Result: <strong id="conversion-result"></strong>
        </div>
        <pre id="conversion-details"></pre>
    </section>

    <script>
        // Browser timezone detection
        document.getElementById('browser-timezone').textContent = 
            Intl.DateTimeFormat().resolvedOptions().timezone || "Not detected";
        
        const offset = new Date().getTimezoneOffset();
        const offsetHours = Math.abs(Math.floor(offset / 60));
        const offsetMinutes = Math.abs(offset % 60);
        const offsetSign = offset <= 0 ? "+" : "-"; // Note: getTimezoneOffset() returns the opposite of what you'd expect
        document.getElementById('timezone-offset').textContent = 
            `${offsetSign}${offsetHours.toString().padStart(2, '0')}:${offsetMinutes.toString().padStart(2, '0')} (${offset} minutes)`;
        
        document.getElementById('local-time').textContent = new Date().toLocaleTimeString();
        
        // Luxon timezone detection
        document.getElementById('luxon-timezone').textContent = 
            luxon.DateTime.local().zoneName || "Not detected";
        
        document.getElementById('luxon-datetime').textContent = 
            luxon.DateTime.local().toString();
        
        document.getElementById('luxon-offset').textContent = 
            luxon.DateTime.local().toFormat('ZZ');
        
        document.getElementById('luxon-formatted').textContent = 
            luxon.DateTime.local().toFormat('HH:mm - ZZZZ');
        
        // Time conversion test
        document.getElementById('convert-btn').addEventListener('click', function() {
            const timeInput = document.getElementById('test-time').value;
            if (!timeInput) return;
            
            const [hours, minutes] = timeInput.split(':').map(Number);
            
            const now = new Date();
            const localDate = new Date(
                now.getFullYear(), 
                now.getMonth(), 
                now.getDate(), 
                hours, 
                minutes
            );
            
            // Using JavaScript Date
            const utcHours = localDate.getUTCHours();
            const utcMinutes = localDate.getUTCMinutes();
            const jsResult = `${utcHours.toString().padStart(2, '0')}:${utcMinutes.toString().padStart(2, '0')}`;
            
            // Using Luxon
            const localDT = luxon.DateTime.fromObject({
                hour: hours,
                minute: minutes
            });
            const utcDT = localDT.toUTC();
            const luxonResult = utcDT.toFormat('HH:mm');
            
            // Display results
            document.getElementById('conversion-result').textContent = 
                `Local ${timeInput} â†’ UTC ${luxonResult}`;
            
            document.getElementById('conversion-details').textContent = 
                `JavaScript Date: ${jsResult}\n` +
                `Luxon: ${luxonResult}\n\n` +
                `Local DateTime: ${localDT.toString()}\n` +
                `UTC DateTime: ${utcDT.toString()}\n`;
        });
    </script>
</body>
</html> 